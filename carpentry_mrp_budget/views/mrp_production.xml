<?xml version="1.0" encoding="utf-8" ?>
<odoo>

    <!-- Production Form -->
    <record id="mrp_production_form_view" model="ir.ui.view">
        <field name="name">mrp.production.form.carpentry_budget</field>
        <field name="model">mrp.production</field>
        <field name="inherit_id" ref="carpentry_mrp.mrp_production_form_view" />
        
        <field name="arch" type="xml">

            <!-- Components: add price_unit -->
            <xpath expr="//field[@name='move_raw_ids']//button[@name='action_show_details']" position="inside">
                <field name="currency_id" invisible="1" />
                <field name="price_unit" readonly="1" widget="monetary" optional="hide" groups="base.group_no_one" />
                <field name="standard_price" widget="monetary" optional="hide" groups="base.group_no_one" />

                <field
                    name="analytic_distribution"
                    widget="analytic_distribution"
                    groups="analytic.group_analytic_accounting"
                    options="{'product_field': 'product_id', 'business_domain': 'stock_move'}"
                    optional="hide"
                />
            </xpath>

            <!-- Workorder : add total budget reservation below operations table -->
            <page name="operations" position="inside">
                <div name="budget_workorder" class="oe_right text-right">
                    <div name="budget_workorder_total">
                        Budget reservation total:
                        <strong class="fs-4">
                            <field name="total_budget_reserved_workorders" widget="float_time" /> h:min
                        </strong>
                    </div>
                    
                    <div name="budget_workorder_difference"
                        attrs="{'invisible': [('difference_workorder_duration_budget', '=', 0.0)]}"
                        class="text-danger"
                    >
                        Difference:
                        <strong class="fs-4">
                            <field name="difference_workorder_duration_budget" widget="float_time" /> h:min
                        </strong>
                    </div>
                </div>
            </page>

        </field>
    </record>

</odoo>
